# -*- coding: utf-8 -*-
"""streamlit.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Vsl6eLR_GYPiT5zJpXMaHCtS9x9a1ucq
"""

import tensorflow as tf
from tensorflow import keras
import streamlit as st
import numpy as np
from PIL import Image

# Load your trained Keras model
model = keras.models.load_model('/content/drive/MyDrive/kidneymodel/inception.h5')

# Define the function that will make predictions using your model
def predict(image):
    # Preprocess the input image
    img = image.resize((224, 224))
    img = np.array(img)
    img = img.reshape((1, 224, 224, 3))
    img = img / 255.0
    
    # Make predictions using your model
    pred = model.predict(img)
    
    # Return the predicted class and probability
    return pred[0][0]

# Define the main function that will display the app
def main():
    # Set the app's layout and title
    st.set_option('deprecation.showfileUploaderEncoding', False)
    st.title('Kidney Stone Detection')
    
    # Create the app's sidebar
    st.sidebar.title('Upload Image')
    uploaded_file = st.sidebar.file_uploader('Choose an image', type=['jpg', 'jpeg', 'png'])
    
    # Check if an image has been uploaded
    if uploaded_file is not None:
        # Display the uploaded image
        image = Image.open(uploaded_file)
        st.image(image, caption='Uploaded Image', use_column_width=True)
        
        # Make predictions using your model
        pred = predict(image)
        
        # Display the predicted class and probability
        if pred > 0.5:
            st.write('This is a kidney stone with probability', pred)
        else:
            st.write('This is a normal kidney with probability', 1-pred)
    else:
        st.write('Please upload an image to make predictions')

if __name__ == '__main__':
    main()


